.. index:: pair: class; dnnl::graph::logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor:

class dnnl::graph::logical_tensor
=================================

.. toctree::
	:hidden:

	enum_dnnl_graph_logical_tensor_data_type.rst
	enum_dnnl_graph_logical_tensor_layout_type.rst
	enum_dnnl_graph_logical_tensor_property_type.rst

Overview
~~~~~~~~

Logical tensor object. :ref:`More...<details-classdnnl_1_1graph_1_1logical__tensor>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <dnnl_graph.hpp>
	
	class logical_tensor
	{
	public:
		// typedefs
	
		typedef std::vector<:ref:`dnnl_dim_t<doxid-group__dnnl__api__data__types_1ga872631b12a112bf43fba985cba24dd20>`> :target:`dims_t<doxid-classdnnl_1_1graph_1_1logical__tensor_1a020a54718619266d53f4aa131ec0b433>`;

		// enums
	
		enum :ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>`;
		enum :ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>`;
		enum :ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>`;

		// methods
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a01cec4c5633637fb344d03e5547f9945>`();
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a8557c46e004ed95249688ccc1e29fdc6>`(const :ref:`dnnl_graph_logical_tensor_t<doxid-structdnnl__graph__logical__tensor__t>`& c_data);
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad9e3190a8cbabfcdbfae558284711208>`(const logical_tensor& other);
		logical_tensor& :ref:`operator =<doxid-classdnnl_1_1graph_1_1logical__tensor_1afbb1d508c701fd9d09409e0dae4e67e2>` (const logical_tensor& other);
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a710c862218dd3ed13b5ac254f670d9f6>`(
			size_t tid,
			:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
			int32_t ndims,
			:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype,
			:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
			);
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a65a85083e3ef174e1353ad7a9b4ecc65>`(
			size_t tid,
			:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
			:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype = :ref:`layout_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867af31ee5e3824f1f5e5d206bdf3029f22b>`
			);
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a7cba105f875ba265f4959e61dbbaca46>`(
			size_t tid,
			:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
			const dims_t& adims,
			:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype,
			:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
			);
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1a1d5791c5721243c101b84f1917e43115>`(
			size_t tid,
			:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
			const dims_t& adims,
			const dims_t& strides,
			:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
			);
	
		:ref:`logical_tensor<doxid-classdnnl_1_1graph_1_1logical__tensor_1aae7c820cac0245ffa0e05960e9939349>`(
			size_t tid,
			:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
			const dims_t& adims,
			size_t lid,
			:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
			);
	
		dims_t :ref:`get_dims<doxid-classdnnl_1_1graph_1_1logical__tensor_1a881ed84d09c0e6ab839051c3d081f856>`() const;
		size_t :ref:`get_id<doxid-classdnnl_1_1graph_1_1logical__tensor_1a737bf8c4de5068843b05afb3e84d8db8>`() const;
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` :ref:`get_data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a9d23e64fb07e6df184a83aa00e734ec8>`() const;
		:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` :ref:`get_property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a8f65d86e0fbea8a9544b0cde15d248b8>`() const;
		:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` :ref:`get_layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1abb0ea0925acbe293a9e4be9ac1f1fee4>`() const;
		size_t :ref:`get_layout_id<doxid-classdnnl_1_1graph_1_1logical__tensor_1aaf98c3b5f4117b784605b9e3032d86c5>`() const;
		dims_t :ref:`get_strides<doxid-classdnnl_1_1graph_1_1logical__tensor_1a62b5941feefc095a9799678b40dff3ad>`() const;
		size_t :ref:`get_mem_size<doxid-classdnnl_1_1graph_1_1logical__tensor_1adf33f92edaf8abfd7920048058acf5bc>`() const;
		bool :ref:`is_equal<doxid-classdnnl_1_1graph_1_1logical__tensor_1a58fb4a09bc180292e7c83a7e7ac3f867>`(const logical_tensor& lt) const;
	};
.. _details-classdnnl_1_1graph_1_1logical__tensor:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

Logical tensor object.

Methods
-------

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a01cec4c5633637fb344d03e5547f9945:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor()

default constructor construct an empty object

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a8557c46e004ed95249688ccc1e29fdc6:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(const :ref:`dnnl_graph_logical_tensor_t<doxid-structdnnl__graph__logical__tensor__t>`& c_data)

Constructs a logical tensor object.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1ad9e3190a8cbabfcdbfae558284711208:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(const logical_tensor& other)

Copy.

.. index:: pair: function; operator=
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1afbb1d508c701fd9d09409e0dae4e67e2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor& operator = (const logical_tensor& other)

Assign.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a710c862218dd3ed13b5ac254f670d9f6:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(
		size_t tid,
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
		int32_t ndims,
		:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype,
		:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
		)

Constructs a logical tensor object with ID, data type, ndims, layout type, and property type.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- tid

		- Logical tensor ID.

	*
		- dtype

		- Elements data type.

	*
		- ndims

		- Number of dimensions. -1 means unknown (see #DNNL_GRAPH_UNKNOWN_NDIM) and 0 means a scalar tensor.

	*
		- ltype

		- Layout type.

	*
		- ptype

		- Property type.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a65a85083e3ef174e1353ad7a9b4ecc65:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(
		size_t tid,
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
		:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype = :ref:`layout_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867af31ee5e3824f1f5e5d206bdf3029f22b>`
		)

Delegated constructor.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- tid

		- Logical tensor ID.

	*
		- dtype

		- Elements data type.

	*
		- ltype

		- Layout type.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a7cba105f875ba265f4959e61dbbaca46:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(
		size_t tid,
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
		const dims_t& adims,
		:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` ltype,
		:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
		)

Constructs a logical tensor object with basic information and detailed dims.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- tid

		- Logical tensor ID.

	*
		- dtype

		- Elements data type.

	*
		- adims

		- Logical tensor dimensions. :ref:`DNNL_GRAPH_UNKNOWN_DIM <doxid-group__dnnl__graph__api__logical__tensor_1ga45a2f66e2234c3ff0c5d4a06582cca84>` means the size of that dimension is unknown. 0 is used to define zero-dimension tensor.

	*
		- ltype

		- Layout type. If it's strided, the strides field in the output logical tensor will be deduced accordingly.

	*
		- ptype

		- Property type.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a1d5791c5721243c101b84f1917e43115:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(
		size_t tid,
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
		const dims_t& adims,
		const dims_t& strides,
		:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
		)

Constructs a logical tensor object with detailed dims and strides.

The layout_type of the output logical tensor object will always be strided.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- tid

		- Logical tensor ID.

	*
		- dtype

		- Elements data type.

	*
		- adims

		- Logical tensor dimensions. :ref:`DNNL_GRAPH_UNKNOWN_DIM <doxid-group__dnnl__graph__api__logical__tensor_1ga45a2f66e2234c3ff0c5d4a06582cca84>` means the size of that dimension is unknown. 0 is used to define zero-dimension tensor.

	*
		- strides

		- Logical tensor strides. :ref:`DNNL_GRAPH_UNKNOWN_DIM <doxid-group__dnnl__graph__api__logical__tensor_1ga45a2f66e2234c3ff0c5d4a06582cca84>` means the stride of the dimension is unknown. The library currently doesn't support other negative stride values.

	*
		- ptype

		- Property type.

.. index:: pair: function; logical_tensor
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1aae7c820cac0245ffa0e05960e9939349:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	logical_tensor(
		size_t tid,
		:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` dtype,
		const dims_t& adims,
		size_t lid,
		:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` ptype = :ref:`property_type::undef<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82af31ee5e3824f1f5e5d206bdf3029f22b>`
		)

Constructs a logical tensor object with detailed dims and an opaque layout ID.

layout_type of the output logical tensor object will always be opaque.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- tid

		- Logical tensor ID.

	*
		- dtype

		- Elements data type.

	*
		- adims

		- Logical tensor dimensions. :ref:`DNNL_GRAPH_UNKNOWN_DIM <doxid-group__dnnl__graph__api__logical__tensor_1ga45a2f66e2234c3ff0c5d4a06582cca84>` means the size of that dimension is unknown. 0 is used to define zero-dimension tensor.

	*
		- lid

		- Opaque layout id.

	*
		- ptype

		- Property type

.. index:: pair: function; get_dims
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a881ed84d09c0e6ab839051c3d081f856:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	dims_t get_dims() const

Returns dimensions of a logical tensor.



.. rubric:: Returns:

A vector describing the size of each dimension.

.. index:: pair: function; get_id
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a737bf8c4de5068843b05afb3e84d8db8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	size_t get_id() const

Returns the unique id of a logical tensor.



.. rubric:: Returns:

An integer value describing the ID.

.. index:: pair: function; get_data_type
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a9d23e64fb07e6df184a83aa00e734ec8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`data_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1acddb1dc65b7b4feede7710a719f32227>` get_data_type() const

Returns the data type of a logical tensor.



.. rubric:: Returns:

The data type.

.. index:: pair: function; get_property_type
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a8f65d86e0fbea8a9544b0cde15d248b8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`property_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1a037ba7c242d8127d2f42c0c2aef29d82>` get_property_type() const

Returns the property type of a logical tensor.



.. rubric:: Returns:

The property type.

.. index:: pair: function; get_layout_type
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1abb0ea0925acbe293a9e4be9ac1f1fee4:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`layout_type<doxid-classdnnl_1_1graph_1_1logical__tensor_1ad3fcaff44671577e56adb03b770f4867>` get_layout_type() const

Returns the layout type of a logical tensor.



.. rubric:: Returns:

The layout type.

.. index:: pair: function; get_layout_id
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1aaf98c3b5f4117b784605b9e3032d86c5:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	size_t get_layout_id() const

Returns the layout ID of a logical tensor.

The API should be called on a logical tensor with opaque layout type. Otherwise, an exception will be raised.



.. rubric:: Returns:

Layout ID.

.. index:: pair: function; get_strides
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a62b5941feefc095a9799678b40dff3ad:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	dims_t get_strides() const

Returns the strides of a logical tensor.

The API should be called on a logical tensor with strided layout type. Otherwise, an exception will be raised.



.. rubric:: Returns:

A vector describing the stride size of each dimension.

.. index:: pair: function; get_mem_size
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1adf33f92edaf8abfd7920048058acf5bc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	size_t get_mem_size() const

Returns memory size in bytes required by this logical tensor.



.. rubric:: Returns:

The memory size in bytes.

.. index:: pair: function; is_equal
.. _doxid-classdnnl_1_1graph_1_1logical__tensor_1a58fb4a09bc180292e7c83a7e7ac3f867:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool is_equal(const logical_tensor& lt) const

Compares if two logical tenors are equal.

Users can decide accordingly if layout reordering is needed for two logical tensors. The method will return true for below two circumstances:

#. the two logical tensors are equal regarding each field in the struct, eg. id, ndims, dims, layout type, property, etc.

#. If all other fields are equal but the layout types in two logical tensors are different, the method will return true when the underlying memory layout is the same. For example, one logical tensor has strided layout type while the other one has opaque layout type, but underneath, both layouts are NHWC, the method will still return true for this case.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- lt

		- The input logical tensor to be compared.



.. rubric:: Returns:

``true`` if the two logical tensors are equal. ``false`` otherwise

